{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import axios from'axios';import'./styles/adDetail.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdDetail=()=>{const{ad_id}=useParams();const[ad,setAd]=useState(null);const[bids,setBids]=useState([]);// Состояние для хранения ставок\nconst[showModal,setShowModal]=useState(false);const[bidAmount,setBidAmount]=useState('');useEffect(()=>{const fetchAd=async()=>{try{const response=await axios.get(\"http://localhost:8000/get_ad/\".concat(ad_id));setAd(response.data);}catch(error){console.error('Error fetching ad:',error);}};const fetchBids=async()=>{try{const response=await axios.get(\"http://localhost:8000/get_bids/\".concat(ad_id));setBids(response.data);}catch(error){console.error('Error fetching bids:',error);}};fetchAd();fetchBids();},[ad_id]);const handleBid=async()=>{try{const userId=localStorage.getItem('user');// Предполагается, что ID пользователя хранится в localStorage\nif(userId){await axios.post('http://localhost:8000/place_bid',{ad_id:ad_id,user_id:JSON.parse(userId).user_id,bid_amount:bidAmount});setShowModal(false);setBidAmount('');alert('Ставка успешно размещена!');}else{alert('Пожалуйста, войдите в систему, чтобы сделать ставку.');}}catch(error){console.error('Error placing bid:',error);}};if(!ad){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"ad-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-section\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"data:image/jpeg;base64,\".concat(ad.photo),alt:ad.title}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowModal(true),children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0441\\u0442\\u0430\\u0432\\u043A\\u0443\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"right-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:ad.title}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0413\\u043E\\u0440\\u043E\\u0434:\"}),\" \",ad.city]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u044C\\u043D\\u0430\\u044F \\u0446\\u0435\\u043D\\u0430:\"}),\" \",ad.start_price]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F:\"}),\" \",ad.category]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435:\"}),\" \",ad.description]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bids-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0421\\u0442\\u0430\\u0432\\u043A\\u0438:\"}),bids.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"bids-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0421\\u0442\\u0430\\u0432\\u043A\\u0430\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bids.map(bid=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:bid.user_name}),/*#__PURE__*/_jsx(\"td\",{children:bid.bid_amount})]},bid.bid_id))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435\\u0442 \\u0441\\u0442\\u0430\\u0432\\u043E\\u043A\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal \".concat(showModal?'show':''),onClick:()=>setShowModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0441\\u0442\\u0430\\u0432\\u043A\\u0443\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:bidAmount,onChange:e=>setBidAmount(e.target.value),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0443\\u043C\\u043C\\u0443 \\u0441\\u0442\\u0430\\u0432\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBid,children:\"\\u041E\\u041A\"})]})})]});};export default AdDetail;","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","jsx","_jsx","jsxs","_jsxs","AdDetail","ad_id","ad","setAd","bids","setBids","showModal","setShowModal","bidAmount","setBidAmount","fetchAd","response","get","concat","data","error","console","fetchBids","handleBid","userId","localStorage","getItem","post","user_id","JSON","parse","bid_amount","alert","children","className","src","photo","alt","title","onClick","city","start_price","category","description","length","map","bid","user_name","bid_id","e","stopPropagation","type","value","onChange","target","placeholder"],"sources":["D:/React Roadstar New/roadstar/src/components/AdDetail.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './styles/adDetail.css';\r\n\r\nconst AdDetail = () => {\r\n  const { ad_id } = useParams();\r\n  const [ad, setAd] = useState(null);\r\n  const [bids, setBids] = useState([]); // Состояние для хранения ставок\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [bidAmount, setBidAmount] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchAd = async () => {\r\n      try {\r\n        const response = await axios.get(`http://localhost:8000/get_ad/${ad_id}`);\r\n        setAd(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching ad:', error);\r\n      }\r\n    };\r\n\r\n    const fetchBids = async () => {\r\n      try {\r\n        const response = await axios.get(`http://localhost:8000/get_bids/${ad_id}`);\r\n        setBids(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching bids:', error);\r\n      }\r\n    };\r\n\r\n    fetchAd();\r\n    fetchBids();\r\n  }, [ad_id]);\r\n\r\n  const handleBid = async () => {\r\n    try {\r\n      const userId = localStorage.getItem('user'); // Предполагается, что ID пользователя хранится в localStorage\r\n      if (userId) {\r\n        await axios.post('http://localhost:8000/place_bid', {\r\n          ad_id: ad_id,\r\n          user_id: JSON.parse(userId).user_id,\r\n          bid_amount: bidAmount\r\n        });\r\n        setShowModal(false);\r\n        setBidAmount('');\r\n        alert('Ставка успешно размещена!');\r\n      } else {\r\n        alert('Пожалуйста, войдите в систему, чтобы сделать ставку.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error placing bid:', error);\r\n    }\r\n  };\r\n\r\n  if (!ad) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"ad-detail\">\r\n      <div className=\"left-section\">\r\n        <img src={`data:image/jpeg;base64,${ad.photo}`} alt={ad.title} />\r\n        <button onClick={() => setShowModal(true)}>Сделать ставку</button>\r\n      </div>\r\n      <div className=\"right-section\">\r\n        <h2>{ad.title}</h2>\r\n        <p><strong>Город:</strong> {ad.city}</p>\r\n        <p><strong>Начальная цена:</strong> {ad.start_price}</p>\r\n        <p><strong>Категория:</strong> {ad.category}</p>\r\n        <p><strong>Описание:</strong> {ad.description}</p>\r\n        <div className=\"bids-section\">\r\n          <h3>Ставки:</h3>\r\n          {bids.length > 0 ? (\r\n            <table className=\"bids-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Имя пользователя</th>\r\n                  <th>Ставка</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {bids.map((bid) => (\r\n                  <tr key={bid.bid_id}>\r\n                    <td>{bid.user_name}</td>\r\n                    <td>{bid.bid_amount}</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          ) : (\r\n            <p>Нет ставок</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className={`modal ${showModal ? 'show' : ''}`} onClick={() => setShowModal(false)}>\r\n        <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n          <h2>Сделать ставку</h2>\r\n          <input\r\n            type=\"number\"\r\n            value={bidAmount}\r\n            onChange={(e) => setBidAmount(e.target.value)}\r\n            placeholder=\"Введите сумму ставки\"\r\n          />\r\n          <button onClick={handleBid}>ОК</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}